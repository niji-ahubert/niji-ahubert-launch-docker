{% extends 'base.html.twig' %}

{% block title %}Test Logs en temps réel avec Turbo{% endblock %}

{% block breadcrumb %}
    {{ parent() }}
    <twig:Breadcrumb label="{{ client }}" path="{{ path('app_project_list_by_client', {'client': project.client}) }}"/>
    <twig:Breadcrumb label="{{ project.project }}"
                     path="{{ path('app_project_list_by_client', {'client': project.client}) }}"/>
    <twig:Breadcrumb label="{{ title }}"/>
{% endblock %}

{% block body %}
    <div class="bg-white dark:bg-gray-800 relative shadow-md sm:rounded-lg overflow-hidden"
         data-controller="docker-logs"
         data-docker-logs-start-url-value="{{ path(route, {'client': project.client, 'project': project.project}) }}"
         data-docker-logs-auto-scroll-value="true">
        <div class="mx-4 py-4">
            <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Test Logs avec Turbo Streams</h1>

            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
                    <span class="inline-flex items-center gap-2">
                        <span class="w-2.5 h-2.5 bg-emerald-400 rounded-full"></span>
                        <span>Connecté aux logs</span>
                    </span>
                </div>
                <div class="flex items-center gap-2">
                    <button data-docker-logs-target="clearButton"
                            type="button"
                            class="px-3 py-1.5 rounded border border-gray-300 dark:border-gray-600 text-sm text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i class="fas fa-trash-alt mr-1"></i>
                        Vider
                    </button>
                    <button data-action="click->docker-logs#toggleAutoScroll"
                            type="button"
                            class="px-3 py-1.5 rounded border border-gray-300 dark:border-gray-600 text-sm text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i class="fas fa-arrows-alt-v mr-1"></i>
                        Auto-scroll
                    </button>
                    <button data-action="click->docker-logs#scrollToBottomAction"
                            type="button"
                            class="px-3 py-1.5 rounded border border-gray-300 dark:border-gray-600 text-sm text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700">
                        <i class="fas fa-arrow-down mr-1"></i>
                        Bas
                    </button>
                </div>
            </div>

            <div data-docker-logs-target="logsContainer"
                 class="h-96 overflow-y-auto bg-black text-green-200 font-mono text-sm p-3 rounded border-2 border-gray-300 dark:border-gray-600">
                <div data-docker-logs-target="messages"
                     id="messages"
                     {{turbo_stream_listen('chat','default',{withCredentials: true}) }}>
                    <!-- Les logs apparaîtront ici via Turbo Streams -->
                </div>
            </div>

            <div class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                <i class="fas fa-info-circle mr-1"></i>
                Les logs défilent automatiquement vers le bas. Utilisez les boutons ci-dessus pour contrôler l'affichage.
            </div>
        </div>
    </div>
{% endblock %}
